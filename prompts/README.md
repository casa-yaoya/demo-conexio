# ナレトレ プロンプト設計書

このディレクトリには、ナレトレ管理ページで使用する各種AIエージェントのプロンプト設計書が含まれています。

## 概要

ナレトレシステムは、Claude Code APIを使用して複数のエージェントを連携させ、ロープレ学習コンテンツの生成と実行を自動化します。

## エージェント構成

### 1. ロープレ構築支援エージェント
**ファイル**: `roleplay-support-agent.md`

**役割**: チャットエリアでユーザーとコミュニケーションを行い、ロープレ内容を設計する。

**使用タイミング**:
- ファイルアップロード時
- テキスト入力時

**出力**: ロープレ設計（シチュエーション、相手の設定、ミッション、ポイント）

---

### 2. 台本生成エージェント群

#### 2-1. 台本モード用
**ファイル**: `script-generation-subtitle.md`

お手本の流れを学ぶための台本を生成。

#### 2-2. ポイントモード用（お手本モード）
**ファイル**: `script-generation-points.md`

先生とプレイヤーの問答形式の台本を生成。

#### 2-3. 実践モード用
**ファイル**: `script-generation-practice.md`

難易度の高いリアルな会話の台本を生成。

**共通の使用タイミング**: 「ロープレ生成」ボタンクリック時

---

### 3. 設計書生成エージェント群

各モード用のOpenAI Realtime API用システムプロンプトを生成します。

#### 3-1. 台本モード用
**ファイル**: `system-prompt-subtitle-mode.md`

台本通りに話せているかをチェックするAIの動作を定義。

#### 3-2. お手本モード用
**ファイル**: `system-prompt-aiDemo-mode.md`

優秀な先輩役として模範的な営業を実演するAIの動作を定義。

#### 3-3. 確認モード用
**ファイル**: `system-prompt-confirmation-mode.md`

ポイント理解度を確認する先生役AIの動作を定義。

#### 3-4. 実践モード用
**ファイル**: `system-prompt-practice-mode.md`

難しいお客さん役として、プレイヤーを試すAIの動作を定義。

**共通の使用タイミング**: 台本生成後

---

### 4. フィードバックエージェント
**ファイル**: `feedback-prompt.md`

**役割**: ロープレ終了後、会話ログを分析して100点満点で評価する。

**使用タイミング**: ロープレ完了時

**出力**: 採点結果、詳細評価、改善点のフィードバック

---

## データフロー

```
ユーザー入力/ファイル
    ↓
[1] ロープレ構築支援エージェント
    ↓ (ロープレ設計)
[2] 台本生成エージェント（4種）
    ↓ (台本データ)
[3] 設計書生成エージェント（4種）
    ↓ (システムプロンプト)
実際のロープレ実行 (OpenAI Realtime API)
    ↓ (会話ログ)
[4] フィードバックエージェント
    ↓
結果表示
```

## ロープレ設計フォーマット

### ①シチュエーション
プレイヤーが置かれた状況（300文字以内）

### ②相手の設定
- 立場・役職
- 性格・特徴
- 抱えている課題

### ③ミッション
- **必須**: 絶対にクリアすべき内容
- **採点**: 減点対象となる内容
- **失敗**: 一発アウトとなる条件

### ④ポイント
Q&A形式で学習内容を定義
```
（問）質問内容
（正解基準）
・ポイント1
・ポイント2
（正答例）具体的な回答例
```

## 実装状況

### 完了
- ✅ プレイエリアUI修正（相手アイコンポップアップ化、映像設定非表示）
- ✅ ログアウト機能実装
- ✅ ログイン画面実装
- ✅ 全エージェントのプロンプト設計書作成

### 今後の実装（未完了）
- ⏳ ロープレ設計フォーマットの変更適用
- ⏳ 各エージェントのコード統合
- ⏳ Claude Code API連携実装
- ⏳ エージェント間のデータ受け渡し実装

## 技術スタック

- **フロントエンド**: HTML, CSS, JavaScript
- **AI API**:
  - Claude Code API（エージェント制御）
  - OpenAI Realtime API（音声会話）
- **バックエンド**: Node.js (server.js)

## 注意事項

1. **API認証**: Claude Code APIキーとOpenAI APIキーが必要
2. **モード別プロンプト**: 各モードで異なるプロンプトが必要
3. **データ保存**: 生成されたプロンプトと台本はDBまたはファイルに保存
4. **エラーハンドリング**: AI生成失敗時の適切なフォールバック処理が必要

## 更新履歴

- 2025-11-24: 初版作成、全プロンプト設計書完成
